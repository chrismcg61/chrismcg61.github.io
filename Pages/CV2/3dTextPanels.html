<!DOCTYPE html>
<html>
<head>
	<title>3D Text Panels</title>
	
  
	<script src="https://cdn.rawgit.com/mrdoob/three.js/r124/build/three.min.js"></script>
	<script src="https://cdn.rawgit.com/mrdoob/three.js/r124/examples/js/libs/dat.gui.min.js"></script>
	<script src="https://cdn.rawgit.com/mrdoob/three.js/r124/examples/js/libs/stats.min.js"></script>
	<script src="https://cdn.rawgit.com/chrismcg61/TechDemos/1.94/MyLibs/Three/My3D.js"></script>
	<script src="https://cdn.rawgit.com/chrismcg61/TechDemos/1.94/Libs/PostFX.js"></script>

	<script src="https://cdn.rawgit.com/mrdoob/three.js/r138/examples/js/objects/Reflector.js"></script>

	<script src="https://chrismcg61.github.io/Pages/CV3/DataMgt.js"></script>
	<script src="https://chrismcg61.github.io/Pages/CV3/DataCV.js"></script>
</head>

<body>
</body>



<script>
	MY3D.preInit(THREE);
	var stats = new Stats();  document.body.appendChild( stats.dom );
	var gui = new dat.GUI();

	var params = { camPosX:0.0,camPosY:0.8,camPosZ:3,   fogCol:0x224444,fogDensity:1.7,   Bloom:{intensity:1.2,radius:0.1,threshold:0.1},    };
	var gParams = { RESTART:ReInit,exposure:1.2,  lightCol:0xff2222,lightIntensity:1.5,lightPosX:0,lightPosY:0.3,lightPosZ:-5,  speed:0.01   };
	var hiddenParams = { HiddenParams:params, };
	var showParams = { MainParams:gParams, };
	MY3D.addGuiParams(gui, hiddenParams, false, 10,0.01);
	MY3D.addGuiParams(gui, showParams, true, 10,0.01);

	var light;
	var ZZ, txtPanelContainer;
	ReInit();
	function ReInit0(){
	  scene = new THREE.Scene();
	  scene.add(camera);  
	  renderer.toneMapping = THREE.ReinhardToneMapping;
	  // renderer.shadowMap.enabled = true;  
	  renderer.shadowMap.type = THREE.PCFSoftShadowMap;
	  MY3D.initBloom(params.Bloom.intensity,params.Bloom.radius,params.Bloom.threshold);  
	}
	function ReInit(){
	  ZZ = 0;
	  
	  ReInit0();  
	  
	  light = new THREE.PointLight( gParams.lightCol, gParams.lightIntensity, 10, 1.9 );
	  scene.add( light );
	  var lightPane = new THREE.Mesh( new THREE.PlaneGeometry( 0.4,0.4 ), new THREE.MeshStandardMaterial() );  // new THREE.MeshBasicMaterial( {color: 0x00ff00} )
	  lightPane.position.z = -0.1;
	  light.add( lightPane );  
	  
	  var bumpMap = new THREE.TextureLoader().load("https://cdn.rawgit.com/chrismcg61/TechDemos/1.94/Media/Concrete.jpg");
	  bumpMap.wrapS = THREE.RepeatWrapping;   bumpMap.wrapT = THREE.RepeatWrapping;   bumpMap.repeat.set( 10, 10 );
	  const wallMat = new THREE.MeshStandardMaterial( {roughness:0.7,metalness:0.4, side:THREE.DoubleSide, bumpMap:bumpMap,bumpScale:0.9} );
	  
	  const FLOOR_SIZE = 90;
	  var mirror = new THREE.Reflector( new THREE.PlaneGeometry( FLOOR_SIZE,FLOOR_SIZE ),  {
		clipBias: 0.003,
		textureWidth: window.innerWidth * window.devicePixelRatio,
		textureHeight: window.innerHeight * window.devicePixelRatio,
		color: 0x222222
	  } );
	  mirror.rotation.x = -Math.PI/2;
	  scene.add( mirror );
	  
	  const wall1 = new THREE.Mesh( new THREE.PlaneGeometry( FLOOR_SIZE,FLOOR_SIZE, 3,3 ),   wallMat );
	  wall1.position.x = 6;  wall1.rotation.y = -Math.PI/2;  
	  scene.add( wall1 );
	  const wall2 = wall1.clone(); wall2.position.x = -wall1.position.x;
	  scene.add( wall2 );
	  
	  
	  txtPanelContainer = new THREE.Object3D();
	  scene.add(txtPanelContainer);
	  // console.log( techSkills );  
	  // var title = rootData_Pers.subDivs[0].title.txt;
	  // title = rootData_JobTitles.subDivs[0].title.txt;
	  var title = "Chris McGARRY";
	  addTextPanel(title);
	  title = "Versatile Dev";
	  addTextPanel(title);
	  for ( i=0; i<techSkills.length; i++ ) {
		title = (techSkills[i].tagDiv.title).substring(0, 16)
		addTextPanel(title);
	  }  
	}
	function addTextPanel(title){
	  const subTitles = title.split('<');  // stop at html tags
	  const subTitle = subTitles[0]; // .substring(0,20);
	  const WW = 1024;
	  var TXT_W = WW/8;
	  if(subTitle.length>12) TXT_W = WW/10;
	  var newTexture = addTexture(WW);
	  initTexture_Text(newTexture, TXT_W, "", ["▣",subTitle,"▣", ]);
	  // var basicMatText = new THREE.MeshBasicMaterial({map:newTexture});
	  var shaderMatText = initTextShaderMaterial(newTexture);
	  var panel = new THREE.Mesh( new THREE.PlaneGeometry(), shaderMatText );
	  panel.position.set( 2*(Math.random()-0.5), 0.7, ZZ );
	  txtPanelContainer.add( panel );
	  ZZ -= 2;
	}


	animate();
	function animate() {
	  var now = Date.now()*0.0005;
	  requestAnimationFrame( animate );
	  composer.render();
	  // renderer.render( scene, camera );
	  stats.update();
	  
	  renderer.toneMappingExposure = Math.pow( gParams.exposure, 4.0 );
	  scene.background = new THREE.Color( params.fogCol );
	  scene.fog = new THREE.FogExp2( params.fogCol, params.fogDensity*0.01 );      
	  camera.position.set(params.camPosX,params.camPosY,params.camPosZ);
	  {
		light.position.set(gParams.lightPosX,  gParams.lightPosY,  gParams.lightPosZ);  //  + 0.3*Math.sin(now)
		light.intensity = gParams.lightIntensity;
		light.color = new THREE.Color(gParams.lightCol);
	  }
	  
	  txtPanelContainer.position.z += gParams.speed;
	  for ( i=0; i<shaderUniformList.length; i++ ) {
		shaderUniformList[i].time.value += 1.0;
	  }
	}
</script>

</html>
